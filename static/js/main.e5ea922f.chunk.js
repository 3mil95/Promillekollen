(this.webpackJsonppromillekollen=this.webpackJsonppromillekollen||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(7),o=n.n(l),s=(n(13),n(1)),i=n(2),c=n(4),u=n(3),h=n(5),m=(n(14),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).drawGraph=function(){if(n.ctx){console.log("draw",n.props.perMille),n.ctx.clearRect(0,0,400,1e3),n.ctx.fillStyle="#222222",n.ctx.fillRect(25,0,375,650);var e=n.props.pos-200;n.ctx.beginPath(),n.ctx.lineWidth=3,n.ctx.strokeStyle="#ffffff",n.ctx.moveTo(0,650);for(var t=0;t<n.props.perMille.length;t++)n.props.currentTime===t&&(n.currentPromil=n.props.perMille[t],n.ctx.stroke(),n.ctx.strokeStyle="gray",n.ctx.lineWidth=1,n.ctx.beginPath(),n.ctx.lineTo(t-e+5-1,Math.round(650-500*n.props.perMille[t-1]))),n.props.perMille[t]?n.ctx.lineTo(t-e+5-1,Math.round(650-500*n.props.perMille[t])):n.ctx.lineTo(t-e+5-1,650);n.ctx.stroke(),n.createAxes()}},n.createAxes=function(){var e=n.props.pos-200;n.ctx.strokeStyle="gray",n.ctx.lineWidth=1,n.ctx.clearRect(0,0,25,700),n.ctx.beginPath(),n.ctx.moveTo(400,650),n.ctx.lineTo(25,650),n.ctx.lineTo(25,0),n.ctx.stroke();for(var t=0;t<12;t++)n.ctx.beginPath(),n.ctx.strokeStyle="#333333",n.ctx.moveTo(23,50+50*t),n.ctx.lineTo(400,50+50*t),n.ctx.stroke(),n.ctx.stroke(),n.ctx.fillStyle="gray",n.ctx.textAlign="end",n.ctx.textBaseline="middle",n.ctx.font="15px Arial",n.ctx.fillText("".concat(Math.floor((12-t)/10),",").concat((12-t)%10),21,50+50*t);for(var a=0;a<375;a++)Math.round(e+a)%60===0&&(n.ctx.beginPath(),n.ctx.strokeStyle="gray",n.ctx.moveTo(25+a,653),n.ctx.lineTo(25+a,647),n.ctx.stroke(),n.ctx.fillStyle="gray",n.ctx.textAlign="center",n.ctx.font="15px Arial",n.ctx.fillText("".concat(Math.round(e+a)/60%24,":00"),25+a,670))},n.mouseClickedY=null,n.thePos=null,n.handleMouseDown=function(e){n.mouseClickedY||(n.mouseClickedY=e.pageX,n.thePos=n.props.pos)},n.handleMouseUp=function(e){n.mouseClickedY=null,n.thePos=null},n.handleMouseMove=function(e){if(n.mouseClickedY){var t=n.thePos+(n.mouseClickedY-e.pageX);t<n.props.start?t=n.props.start:t>n.props.end&&(t=n.props.end),n.props.setPos(t)}},n.handleTouchStart=function(e){var t=e.touches[0];n.mouseClickedY||(n.mouseClickedY=t.pageX,n.thePos=n.props.pos)},n.handleTouchMove=function(e){var t=e.touches[0];if(n.mouseClickedY){var a=n.thePos+(n.mouseClickedY-t.pageX);n.props.setPos(a)}},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.refs.canvas;this.ctx=e.getContext("2d"),this.props.perMille.length>0&&this.drawGraph()}},{key:"componentDidUpdate",value:function(){this.props.perMille.length>0&&this.drawGraph()}},{key:"render",value:function(){return this.props.perMille.length>0&&this.drawGraph(),r.a.createElement("div",null,r.a.createElement("canvas",{height:"685px",width:"400px",ref:"canvas",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseUp,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleMouseUp,onTouchMove:this.handleTouchMove}),r.a.createElement("div",{className:"graph-nav"},r.a.createElement("button",{className:"add-button",onClick:this.props.handleAdd},"+"),r.a.createElement("h3",null,Math.round(1e3*this.currentPromil)/1e3)))}}]),t}(a.Component)),g=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={type:"",strength:4.5,amount:33,index:0},n.types=[{name:"\xd6l",strength:5,amount:40},{name:"Vin",strength:12,amount:15},{name:"Drink",strength:40,amount:4},{name:"Cider",strength:5,amount:33},{name:"Sprit",strength:40,amount:4}],n.handleSubmit=function(){n.props.handleAdd(n.state.amount,n.state.strength)},n.onSubmit=function(e){e.preventDefault()},n.handleClose=function(){n.props.handleAdd(null,null)},n.handleChange=function(e){"amount"===e.target.name&&n.setState({amount:e.target.value}),"strength"===e.target.name&&n.setState({strength:e.target.value})},n.handleType=function(e){var t=n.state.index+e;n.setState({index:t,amount:n.types[t].amount,strength:n.types[t].strength})},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.handleType(0)}},{key:"render",value:function(){var e=this,t=this.state.index;return r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"modal-page"},r.a.createElement("button",{className:"close-button",onClick:this.handleClose},"Avbryt"),r.a.createElement("form",{onChange:this.handleChange,onSubmit:this.onSubmit,className:"forms"},r.a.createElement("div",null,0!==t?r.a.createElement("button",{onClick:function(){return e.handleType(-1)}},"-"):null,r.a.createElement("label",null,this.types[t].name),t!==this.types.length-1?r.a.createElement("button",{onClick:function(){return e.handleType(1)}},"+"):null),r.a.createElement("label",null,"".concat(this.state.amount," cl")),r.a.createElement("br",null),r.a.createElement("div",{class:"slidecontainer"},r.a.createElement("input",{min:"1",max:"100",value:this.state.amount,className:"slider",type:"range",name:"amount"})),r.a.createElement("br",null),r.a.createElement("label",null,"".concat(this.state.strength,"%")),r.a.createElement("br",null),r.a.createElement("div",{class:"slidecontainer"},r.a.createElement("input",{min:"1",max:"100",value:this.state.strength,className:"slider",step:"0.1",type:"range",name:"strength"}),r.a.createElement("br",null))),r.a.createElement("button",{onClick:this.handleSubmit,className:"confirm-button"},"Klar")))}}]),t}(a.Component),d=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={gender:1,weight:40,length:55},n.map={Man:1,Woman:2,1:"Man",2:"Woman"},n.componentWillUnmount=function(){localStorage.setItem("userWeight",n.state.weight),localStorage.setItem("userLength",n.state.length),localStorage.setItem("userGender",n.map[n.state.gender])},n.handleChange=function(e){"gender"===e.target.name&&n.setState({gender:e.target.value}),"weight"===e.target.name&&n.setState({weight:e.target.value}),"length"===e.target.name&&n.setState({length:e.target.value})},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.map[localStorage.getItem("userGender")],t=localStorage.getItem("userWeight"),n=localStorage.getItem("userLength");this.setState({gender:e,weight:t,length:n})}},{key:"render",value:function(){return r.a.createElement("div",{className:"settings"},r.a.createElement("form",{onChange:this.handleChange,className:"forms"},r.a.createElement("label",null,"".concat(this.map[this.state.gender])),r.a.createElement("br",null),r.a.createElement("div",{class:"slidecontainer"},r.a.createElement("input",{min:"1",max:"2",value:this.state.gender,className:"slider",type:"range",name:"gender"})),r.a.createElement("br",null),r.a.createElement("label",null,"".concat(this.state.weight," kg")),r.a.createElement("br",null),r.a.createElement("div",{class:"slidecontainer"},r.a.createElement("input",{min:"40",max:"220",value:this.state.weight,className:"slider",type:"range",name:"weight"})),r.a.createElement("br",null),r.a.createElement("label",null,"".concat(this.state.length," cl")),r.a.createElement("br",null),r.a.createElement("div",{class:"slidecontainer"},r.a.createElement("input",{min:"55",max:"220",value:this.state.length,className:"slider",type:"range",name:"length"})),r.a.createElement("br",null)))}}]),t}(a.Component),p=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={},n.clear=function(){localStorage.clear()},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"page"},r.a.createElement("h1",null,"History"),r.a.createElement("button",{onClick:this.clear},"Clear"))}}]),t}(a.Component),f=[];function v(e,t){for(var n=1;n<61;n++){var a=f[n+t-1]?f[n+t-1]:0;f[n+t-1]=e/1830*(61-n)+a}}var x=function(e){console.log("Create Graph..."),f.splice(0,f.length);var t=[],n=0,a=e[n];if(!a)return{end:0,start:0,perMille:[]};for(var r,l,o=0,s=0;(a||o>0)&&s<2880;){for(;(null===(i=a)||void 0===i?void 0:i.time)===s;){var i;v((r=a.amount,l=a.strength,r*(l/100)*7.89/(localStorage.getItem("userWeight")*("man"===localStorage.getItem("userLength")?.7:.6))),s),a=e[++n]}o+=f[s]?f[s]:0,(o-=.0025)<0&&(o=0),t.push(o),s++}return console.log("Graph Done"),{end:s+400,start:e[0].time-200,perMille:t}},b=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={occasions:[],adding:!1,page:"Graph",currentTime:0,currentDrinks:[],perMille:[],pos:0},n.initLocalStorage=function(){localStorage.getItem("userWeight")||localStorage.setItem("userWeight","80"),localStorage.getItem("userLength")||localStorage.setItem("userLength","190"),localStorage.getItem("userGender")||localStorage.setItem("userGender","man"),localStorage.getItem("occasions")||localStorage.setItem("occasions",JSON.stringify([]))},n.addDrink=function(e,t){if(e){var a=new Date,r=n.state.occasions,l=n.getCurrentOccasion(r);if(null===l){var o={year:a.getFullYear(),month:a.getMonth(),date:a.getDate(),drinks:[]};r.push(o),l=r.length-1}console.log(r);var s=n.getCurrentTime(r);if(console.log(s),s){var i={time:s,amount:parseInt(e),strength:parseInt(t)};r[l].drinks.push(i),n.setState({adding:!1,occasions:r,currentTime:n.getCurrentTime(r),currentDrinks:n.getCurrentDrinks(r),perMille:x(n.getCurrentDrinks(r)).perMille,end:x(n.getCurrentDrinks(r)).end,start:x(n.getCurrentDrinks(r)).start,pos:n.getCurrentTime(r)}),localStorage.setItem("occasions",JSON.stringify(r))}}else n.setState({adding:!1})},n.handleAdd=function(e){n.setState({adding:!0})},n.setPos=function(e){n.setState({pos:e})},n.handlePage=function(e){"Graph"===e&&e===n.state.page&&n.setState({pos:n.getCurrentTime(n.state.occasions)}),n.setState({page:e})},n.getAddDate=function(e){if(console.log("add",e),0===e.length)return null;var t=e.length-1,n=new Date,a=new Date(e[t].year,e[t].month,e[t].date);return(new Date(n.getFullYear(),n.getMonth(),n.getDate())-a)/6e4},n.getCurrentOccasion=function(e){var t=e.length-1;if(e.length<1)return null;var n=new Date,a=new Date(e[t].year,e[t].month,e[t].date),r=new Date(n.getFullYear(),n.getMonth(),n.getDate());return(a-r)/864e5===-1&&n.getHours()<10||a-r===0?t:null},n.getCurrentDrinks=function(e){var t=e[n.getCurrentOccasion(e)];return t?t.drinks:[]},n.getCurrentTime=function(e){if(console.log("hej",n.getAddDate(e)),null===n.getAddDate(e))return null;var t=new Date;return 60*t.getHours()+t.getMinutes()+n.getAddDate(e)},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.initLocalStorage();var t=JSON.parse(localStorage.getItem("occasions")),n=this.getCurrentTime(t);this.setState({occasions:t,currentTime:n,currentDrinks:this.getCurrentDrinks(t),perMille:x(this.getCurrentDrinks(t)).perMille,end:x(this.getCurrentDrinks(t)).end,start:x(this.getCurrentDrinks(t)).start,pos:n}),setInterval((function(){e.setState({currentTime:e.getCurrentTime(e.state.occasions)})}),6e4),console.log(this.state.occasions)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"page"},"Graph"===this.state.page?r.a.createElement(m,{currentTime:this.state.currentTime,pos:this.state.pos,end:this.state.end,start:this.state.start,setPos:this.setPos,perMille:this.state.perMille,handleAdd:this.handleAdd}):null,"History"===this.state.page?r.a.createElement(p,null):null,"Settings"===this.state.page?r.a.createElement(d,null):null,this.state.adding?r.a.createElement(g,{handleAdd:this.addDrink}):null),r.a.createElement("div",{className:"nav"},r.a.createElement("button",{onClick:function(){return e.handlePage("Graph")}},"Graph"),r.a.createElement("button",{onClick:function(){return e.handlePage("History")}},"History"),r.a.createElement("button",{onClick:function(){return e.handlePage("Settings")}},"Settings")))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.e5ea922f.chunk.js.map